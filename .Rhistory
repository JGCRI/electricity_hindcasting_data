summarise(totalchoice = sum(summer_capacity) )
add.share <- add.choice %>%
left_join(add.total, by=c("year") ) %>%
mutate(share = 100* totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
summary <- additions %>%
group_by(overnight_category, fuel_general) %>%
summarise(n=n())
View(summary)
summary <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
group_by(overnight_category, fuel_general) %>%
summarise(n=n())
View(summary)
summary <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(n=n()) %>%
ungroup() %>%
group_by(overnight_category, fuel_general) %>%
summarise(years=n())
View(filter(additions, overnight_category=='nuclear'))
View(filter(form860processed, overnight_category=='nuclear'))
generators <- form860processed %>%
inner_join(mapping, by=c("prime_mover", "fuel") ) %>%
select(year, summer_capacity, overnight_category, fuel_general)
View(filter(generators, overnight_category=='nuclear'))
generators <- form860processed %>%
inner_join(mapping, by=c("prime_mover", "fuel") ) %>%
select(year, in_service, summer_capacity, overnight_category, fuel_general)
View(filter(generators, overnight_category=='nuclear'))
View(summary)
View(additions)
View(filter(additions, overnight_category=='nuclear'))
View(generators)
??ggplot
generators <- form860processed %>%
inner_join(mapping, by=c("prime_mover", "fuel") ) %>%
select(year, in_service, summer_capacity, overnight_category, fuel_general)
additions <- generators %>%
filter(year == in_service) %>%
filter(complete.cases(.))
add.total <- additions %>%
group_by(year) %>%
summarise(totaladd = sum(summer_capacity) )
add.choice <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(totalchoice = sum(summer_capacity) )
add.share <- add.choice %>%
left_join(add.total, by=c("year") ) %>%
mutate(share = 100* totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
View(add.share)
summary <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(n=n()) %>%
ungroup() %>%
group_by(overnight_category, fuel_general) %>%
summarise(years=n())
View(summary)
names(add.share)
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(y=share), colour=choice)
library(ggplo2)
library(ggplot2)
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(y=share), colour=choice)
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(y=share, colour=choice))
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(y=share, fill=choice))
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(fill=share))
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(fill=share, colour=choice))
fill
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_bar(aes(y=share, fill=choice))
names(mpg)
g <- ggplot(mpg, aes(class))
g+ geom_bar()
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) +
geom_col(aes(y=share, fill=choice))
names(capitalcosts)
unique(capitalcosts$year)
add.share <- add.choice %>%
left_join(add.total, by=c("year") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
summary <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(n=n()) %>%
ungroup() %>%
group_by(overnight_category, fuel_general) %>%
summarise(years=n())
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) + geom_col(aes(y=share, fill=choice))
unique(add.share$fuel_general)
add.share %>%
group_by(fuel_general) %>%
lapply(function(fuel) {
ggplot(aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
add.share %>%
group_by(fuel_general) %>%
lapply(function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year, y=share)) + geom_col(aes(fill=choice))
}
add.share %>%
group_by(fuel_general) %>%
lapply(function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(., aes(x=year)) + geom_col(aes(y=share, fill=choice))
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year, y=share)) + geom_col(aes(fill=overnight_category))
}
add.share %>%
group_by(fuel_general) %>%
lapply(function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(., aes(x=year)) + geom_col(aes(y=share, fill=choice))
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year, y=share)) + geom_col(aes(fill=overnight_category))
}
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
lapply(fuels, function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(., aes(x=year)) + geom_col(aes(y=share, fill=choice))
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
lapply(fuels, function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
names(fuels)
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
lapply(fuels, function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
generators <- form860processed %>%
inner_join(mapping, by=c("prime_mover", "fuel") ) %>%
select(year, in_service, summer_capacity, overnight_category, fuel_general)
## NUCLEAR new additions in 1990-1996 work at fractions of MW, but buncha generators from 60s/70s reach ~8000 capacity
additions <- generators %>%
filter(year == in_service) %>%
filter(complete.cases(.))
add.fueltot <- additions %>%
group_by(year, fuel_general) %>%
summarise(totaladd=sum(summer_capacity) )
add.techchoice <- additions %>%
group_by(year, fuel_general, overnight_category) %>%
summarise(totalchoice = sum(summer_capacity))
add.share <- add.choice %>%
left_join(add.fueltot, by=c("year", "fuel_general") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
add.share <- add.techchoice %>%
left_join(add.fueltot, by=c("year", "fuel_general") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[i]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
}
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuels[[fuel]] <- market
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
lapply(fuels, function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
lapply(fuels, function(fuel) {
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
lapply(fuels, function(fuel) {
fuel
ggplot(fuel, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
lapply(fuels, function(f) {
ggplot(f, aes(x=year)) + geom_col(aes(y=overnight_category), fill=choice)
})
lapply(fuels, function(f) {
ggplot(f, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
})
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
lapply(fuelmarkets, function(f) {
ggplot(f, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
})
names(fuelmarkets)
fuels
fuelmarkets <- list()
fuels <- unique(add.share$fuel_general)
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
fuels
fuels[1]
fuels <- as.character(unique(add.share$fuel_general))
fuels
fuels[1]
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
names(fuelmarkets)
fuelmarkets <- list()
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
fuelmarkets[[fuel]] <- market
}
names(fuelmarkets)
lapply(fuelmarkets, function(f) {
ggplot(f, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
})
fuelmarkets[["coal"]]
names(fuelmarkets[["coal"]])
lapply(fuelmarkets, function(f) {
print(names(f))
ggplot(f, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
})
fuelmarkets <- list()
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
}
fuelmarkets <- list()
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year)) + geom_col(aes(y=share), fill=overnight_category)
}
fuelmarkets <- list()
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category))
}
add.fueltot <- additions %>%
group_by(year, fuel_general) %>%
summarise(totaladd=sum(summer_capacity) )
add.techchoice <- additions %>%
group_by(year, fuel_general, overnight_category) %>%
summarise(totalchoice = sum(summer_capacity))
add.share <- add.techchoice %>%
left_join(add.fueltot, by=c("year", "fuel_general") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
fuelmarkets <- list()
fuels <- as.character(unique(add.share$fuel_general))
for (i in seq(1:length(fuels)) ) {
fuel <- fuels[1]
market <- add.share %>%
filter(fuel_general==fuel)
ggplot(market, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category))
}
ggplot(market, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category))
ggplot(market, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category)) + facet_grid(~fuel_general)
ggplot(add.share, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category)) + facet_grid(~fuel_general)
??facet_grid
ggplot(add.share, aes(x=year)) + geom_col(aes(y=share, fill=overnight_category)) + facet_wrap(~fuel_general)
add.fueltot <- additions %>%
group_by(year, overnight_category) %>%
summarise(totaladd=sum(summer_capacity) )
add.techchoice <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(totalchoice = sum(summer_capacity))
add.share <- add.fuelchoice %>%
left_join(add.fueltot, by=c("year", "overnight_category") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
add.share <- add.techchoice %>%
left_join(add.fueltot, by=c("year", "overnight_category") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
ggplot(add.share, aes(x=year)) +
geom_col(aes(y=share, fill=overnight_category)) +
facet_wrap(~fuel_general) +
ggtitle("Nested Fuel Shares given Tech")
View(add.share)
add.fuelchoice <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(totalchoice = sum(summer_capacity))
add.share <- add.fuelchoice %>%
left_join(add.fueltot, by=c("year", "overnight_category") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
ggplot(add.share, aes(x=year)) +
geom_col(aes(y=share, fill=overnight_category)) +
facet_wrap(~fuel_general) +
ggtitle("Nested Fuel Shares given Tech")
add.techtot <- additions %>%
group_by(year, overnight_category) %>%
summarise(totaladd=sum(summer_capacity) )
add.fuelchoice <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(totalchoice = sum(summer_capacity))
add.share <- add.fuelchoice %>%
left_join(add.techtot, by=c("year", "overnight_category") ) %>%
mutate(share = totalchoice/totaladd) %>%
select(year, overnight_category, fuel_general, share)
ggplot(add.share, aes(x=year)) +
geom_col(aes(y=share, fill=overnight_category)) +
facet_wrap(~fuel_general) +
ggtitle("Nested Fuel Shares given Tech")
ggplot(add.share, aes(x=year)) +
geom_col(aes(y=share, fill=fuel_general)) +
facet_wrap(~overnight_category) +
ggtitle("Nested Fuel Shares given Tech")
generators <- form860processed %>%
inner_join(mapping, by=c("prime_mover", "fuel") ) %>%
select(year, in_service, summer_capacity, overnight_category, fuel_general)
## NUCLEAR new additions in 1990-1996 work at fractions of MW, but buncha generators from 60s/70s reach ~8000 capacity
additions <- generators %>%
filter(year == in_service) %>%
filter(complete.cases(.))
add.market <- additions %>%
group_by(year)
join ='year'
# calculate full market capacity additions
add.market <- add.market %>%
summarise(fulladd = sum(summer_capacity) )
# calculate choice's (fuel, tech, or both) capacity additions
add.choice <- additions %>%
group_by(year, overnight_category, fuel_general) %>%
summarise(choiceadd = sum(summer_capacity) )
# calculate choice's share of capacity additions
add.share <- add.choice %>%
left_join(add.market, by=join ) %>%
mutate(share = choiceadd/fulladd) %>%
select(year, overnight_category, fuel_general, share)
add.share %>%
mutate(choice=paste(overnight_category, fuel_general, sep="-")) %>%
ggplot(aes(x=year)) + geom_col(aes(y=share, fill=choice))
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
marketshares(form860processed, mapping, "Fuel")
marketshares(form860processed, mapping, "fuel")
marketshares(form860processed, mapping, "fuel")
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
p <- marketshares(form860processed, mapping, "fuel")
p
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
p <- marketshares(form860processed, mapping, "fuel")
p
marketshares(form860processed, mapping, "fuel")
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
p <- marketshares(form860processed, mapping, "fuel")
p
class(p)
class(2)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
p <- marketshares(form860processed, mapping, "fuel")
p
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
p <- marketshares(form860processed, mapping, "fuel")
marketshares(form860processed, mapping, "fuel")
marketshares(form860processed, mapping, "tech")
marketshares(form860processed, mapping, "tech")
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
marketshares(form860processed, mapping, "tech")
marketshares(form860processed, mapping, "fuel")
marketshares(form860processed, mapping, "total")
marketshares(form860processed, mapping, "total")
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
tech <- marketshares(form860processed, mapping, "tech", additions=FALSE)
tech <- marketshares(form860processed, mapping, "tech")
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
tech <- marketshares(form860processed, mapping, "tech")
tech <- marketshares(form860processed, mapping, "tech", additions=TRUE)
elec <- marketshares(form860processed, mapping, "tech")
elec <- marketshares(form860processed, mapping, "tech", additions=TRUE)
?labs
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "tech", additions=TRUE)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "total", additions=TRUE)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "total", additions=TRUE)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "total", additions=TRUE)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "total", additions=TRUE)
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
source('C:/Users/xavie/Desktop/energy.markets/marketshare.R')
elec <- marketshares(form860processed, mapping, "total")
elec <- marketshares(form860processed, mapping, "total", additions=TRUE)
